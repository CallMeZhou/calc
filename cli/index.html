<!DOCTYPE html>
<html>
<head>
<title>Test Client</title>
<style>
pre {
  line-height: 50%;
  overflow-x: auto;
  word-wrap: nowrap;
}
</style>
</head>
<body>

<h1>Test Client</h1>

<pre style="font-family:courier;" id="my-canvas"/>

<form action="http://127.0.0.1:8000/asca" method="post" enctype="multipart/form-data" id="my-form">
    Select image to upload:
    <input type="file" name="asca-source-image" id="fileToUpload">
    <input type="submit" value="Upload Image" name="submit">
</form>

<script>
function send_data(form) {
    console.log("here!");
    let http = new XMLHttpRequest();

	http.onreadystatechange = function () {
	    if (http.readyState != 4) return;
		
		let my_convas = document.getElementById("my-canvas");
		
		if (http.status == 200) {
	        my_convas.innerHTML = http.responseText;
		} else {
	        my_convas.innerHTML = `Error ${http.status}`;
		}
	};

	http.addEventListener("error", function (event) {
	    document.getElementById("my-canvas").innerHTML = "Network error";
	});
	
	http.open("POST", "http://localhost:8000/asca?requested-width=70");
	http.send(new FormData(form));
}

let form = document.getElementById("my-form");
form.addEventListener("submit", function (event) {
    event.preventDefault();
	send_data(form);
});

</script>

</body>
</html>


